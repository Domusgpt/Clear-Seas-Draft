:root {
  --global-focus-x: 0.5;
  --global-focus-y: 0.5;
  --global-focus-amount: 0;
  --global-scroll-momentum: 0;
  --global-scroll-tilt: 0deg;
  --global-synergy-glow: 0;
  --global-bend-intensity: 0;
  --global-tilt-x: 0;
  --global-tilt-y: 0;
  --global-tilt-strength: 0;
  --global-warp: 0;
  --global-tilt-skew: 0;
  --global-focus-trend: 0;
  --global-scroll-speed: 0;
  --global-scroll-direction: 0;
  --global-rot4d-xw: 0;
  --global-rot4d-yw: 0;
  --global-rot4d-zw: 0;
  --global-visualizer-chaos: 0;
  --global-visualizer-moire: 0;
  --global-visualizer-density: 0;
  --global-visualizer-speed: 0;
  --global-visualizer-saturation: 0;
  --global-brand-accent: #6fe8ff;
  --global-family-focus-boost: 1;
  --global-family-bend-boost: 1;
  --global-family-parallax-scale: 1;
  --global-family-overlay-bloom: 1;
}

body {
  --global-background-shift-x: calc(
    ((var(--global-focus-x) - 0.5) * 12px +
      var(--global-scroll-momentum) * 18px +
      var(--global-tilt-x) * 24px) * var(--global-family-parallax-scale)
  );
  --global-background-shift-y: calc(
    ((0.5 - var(--global-focus-y)) * 10px +
      var(--global-tilt-y) * 22px) * var(--global-family-parallax-scale)
  );
  background-position: calc(50% + var(--global-background-shift-x) + var(--global-focus-trend) * 40px * var(--global-family-parallax-scale)) calc(50% + var(--global-background-shift-y));
  perspective: calc(1600px - var(--global-bend-intensity) * 420px * var(--global-family-bend-boost));
  transform-style: preserve-3d;
  filter: saturate(calc((1 + var(--global-tilt-strength) * 0.12 + var(--global-scroll-speed) * 0.1 + var(--global-visualizer-saturation) * 0.5) * var(--global-family-focus-boost)))
    hue-rotate(calc(var(--global-warp) * 32deg))
    brightness(calc((1 + var(--global-bend-intensity) * 0.08 + var(--global-scroll-speed) * 0.05 + var(--global-focus-trend) * 0.06 + var(--global-visualizer-chaos) * 0.08) * var(--global-family-focus-boost)));
  transform-origin: 50% 50%;
  transform: rotateZ(calc(var(--global-tilt-skew) * 1.4deg * var(--global-scroll-direction)));
  transition: background-position 0.8s ease, filter 0.8s ease;
}

html[data-global-page-family="meta"] {
  --global-family-parallax-scale: 1.12;
  --global-family-focus-boost: 1.08;
  --global-family-bend-boost: 0.82;
  --global-family-overlay-bloom: 1.12;
}

html[data-global-page-family="foundation"] {
  --global-family-parallax-scale: 1;
  --global-family-focus-boost: 1.02;
  --global-family-bend-boost: 1;
  --global-family-overlay-bloom: 1.05;
}

html[data-global-page-family="immersive"] {
  --global-family-parallax-scale: 1.24;
  --global-family-focus-boost: 1.18;
  --global-family-bend-boost: 1.28;
  --global-family-overlay-bloom: 1.25;
}

html[data-global-page-family="labs"] {
  --global-family-parallax-scale: 1.2;
  --global-family-focus-boost: 1.14;
  --global-family-bend-boost: 1.05;
  --global-family-overlay-bloom: 1.32;
}

[data-global-card-group="true"] {
  position: relative;
  z-index: 0;
  --group-focus-amount: 0;
  --group-focus-x: 0.5;
  --group-focus-y: 0.5;
  --group-synergy: 0;
  transform-style: preserve-3d;
  transition: transform 0.6s ease, filter 0.6s ease, box-shadow 0.6s ease;
  overflow: visible;
  transform:
    perspective(calc(1800px - var(--global-bend-intensity) * 520px))
    rotateX(calc(var(--global-tilt-y) * 10deg + (0.5 - var(--group-focus-y)) * 6deg))
    translateZ(calc(var(--group-focus-amount) * 28px + var(--global-bend-intensity) * 12px));
}

[data-global-card-group="true"]::before {
  content: '';
  position: absolute;
  inset: -8% -6%;
  z-index: -2;
  border-radius: clamp(18px, 6vw, 48px);
  background: radial-gradient(
    circle at calc(var(--group-focus-x) * 100%) calc(var(--group-focus-y) * 100%),
    rgba(0, 255, 255, calc(0.08 + var(--group-focus-amount) * 0.35 + var(--group-synergy) * 0.25)),
    rgba(132, 56, 255, calc(0.05 + var(--group-synergy) * 0.25)) 48%,
    rgba(8, 10, 24, 0) 80%
  );
  opacity: calc((0.12 + var(--group-synergy) * 0.4) * var(--global-family-overlay-bloom));
  filter: blur(calc(28px - var(--group-focus-amount) * 12px - var(--global-tilt-strength) * 6px));
  transform:
    translateZ(calc(-60px - var(--global-bend-intensity) * 40px))
    rotateZ(calc(var(--global-warp) * 10deg))
    scale(calc(1 + var(--group-synergy) * 0.08 + var(--global-tilt-strength) * 0.05));
  transition: opacity 0.6s ease, filter 0.6s ease, transform 0.6s ease;
  pointer-events: none;
}

[data-global-card-group="true"] > * {
  position: relative;
  z-index: 1;
}

.visualizer-shell,
.visualizer-shell__canvas,
.card-brand-enhanced .visualizer-shell {
  --visualizer-rot-xw: calc(var(--visualizer-rot-xw-rad, var(--shared-rot4d-xw, var(--global-rot4d-xw))) * 8deg);
  --visualizer-rot-yw: calc(var(--visualizer-rot-yw-rad, var(--shared-rot4d-yw, var(--global-rot4d-yw))) * 8deg);
  --visualizer-rot-zw: calc(var(--visualizer-rot-zw-rad, var(--shared-rot4d-zw, var(--global-rot4d-zw))) * 6deg);
  --visualizer-chaos: var(--visualizer-chaos-local, var(--shared-visualizer-chaos, var(--global-visualizer-chaos)));
  --visualizer-moire: var(--visualizer-moire-local, var(--shared-visualizer-moire, var(--global-visualizer-moire)));
  --visualizer-density: var(--visualizer-density-local, var(--shared-visualizer-density, var(--global-visualizer-density)));
  --visualizer-speed: var(--visualizer-speed-local, var(--shared-visualizer-speed, var(--global-visualizer-speed)));
  --visualizer-saturation: var(--visualizer-saturation-local, var(--shared-visualizer-saturation, var(--global-visualizer-saturation)));
  --visualizer-shell-filter: drop-shadow(0 28px 52px rgba(10, 24, 64, 0.52))
    saturate(calc(1 + var(--visualizer-saturation) * 0.6))
    hue-rotate(calc(var(--shared-warp, var(--global-warp)) * 26deg))
    brightness(calc(1 + var(--visualizer-chaos) * 0.18 + var(--visualizer-moire) * 0.12));
  --visualizer-canvas-filter:
    saturate(calc(1.04 + var(--focus-intensity, 0) * 0.32 + var(--visualizer-saturation) * 0.45))
    brightness(calc(1.04 + var(--focus-intensity, 0) * 0.26 + var(--visualizer-chaos) * 0.12))
    contrast(calc(1.04 + var(--visualizer-moire) * 0.1));
  --visualizer-depth-lift: calc(var(--visualizer-bend-depth, 0px) + var(--visualizer-chaos) * 6px + var(--visualizer-speed) * 4px);
}

.visualizer-shell__canvas::after {
  content: '';
  position: absolute;
  inset: -12%;
  border-radius: inherit;
  background:
    radial-gradient(circle at 50% 50%,
      rgba(111, 232, 255, calc(0.08 + var(--visualizer-chaos) * 0.12 + var(--visualizer-moire) * 0.12)),
      rgba(20, 12, 64, 0) 70%);
  filter:
    blur(calc(18px + var(--visualizer-density) * 6px))
    opacity(calc(0.35 + var(--visualizer-chaos) * 0.2));
  transform:
    translateZ(calc(-40px - var(--visualizer-moire) * 12px))
    scale(calc(1.06 + var(--visualizer-chaos) * 0.05));
  pointer-events: none;
}

[data-global-group-active="true"] {
  filter: saturate(calc(1 + var(--section-synergy, 0) * 0.35))
    brightness(calc(1 + var(--section-synergy, 0) * 0.15));
  transition: filter 0.6s ease;
}

[data-global-card-group="true"] :is(h1, h2, h3, h4, h5, h6,
  .section-title,
  .version-title,
  .card-title,
  .group-title,
  .section-intro,
  .version-description,
  .card-description) {
  transition: color 0.6s ease, text-shadow 0.6s ease, transform 0.6s ease;
}

[data-global-card-group="true"][data-global-group-active="true"] :is(h1, h2, h3, h4, h5, h6,
  .section-title,
  .version-title,
  .card-title,
  .group-title) {
  color: rgba(255, 255, 255, calc(0.82 + var(--group-focus-amount) * 0.25));
  text-shadow:
    0 0 calc(12px + var(--group-focus-amount) * 20px) rgba(0, 255, 255, 0.28),
    0 0 calc(22px + var(--group-synergy) * 40px) rgba(132, 56, 255, 0.24);
  transform: translateZ(calc(var(--group-focus-amount) * 12px));
}

[data-global-card-group="true"][data-global-group-active="true"] :is(.section-intro,
  .version-description,
  .card-description) {
  color: rgba(255, 255, 255, calc(0.68 + var(--group-synergy) * 0.2));
  text-shadow: 0 0 calc(10px + var(--group-synergy) * 16px) rgba(0, 255, 255, 0.18);
}

.global-visualizer-card,
[data-visualizer-card] {
  position: relative;
  transform-style: preserve-3d;
  --card-focus-x: 0.5;
  --card-focus-y: 0.5;
  --card-focus-strength: 0;
  --card-support-intensity: 0;
  --card-scroll-momentum: 0;
  --card-twist: 0deg;
  --card-pulse: 0;
  --card-overlay-shift: 0px;
  --card-visibility-factor: var(--card-visibility, 1);
  --support-distance-z: 0px;
  --support-distance-glow: 0;
  --shared-focus-signal: var(--shared-focus-amount, var(--global-focus-amount, 0));
  --shared-synergy-signal: var(--shared-synergy, var(--global-synergy-glow, 0));
  --shared-tilt-x-signal: var(--shared-tilt-x, var(--global-tilt-x, 0));
  --shared-tilt-y-signal: var(--shared-tilt-y, var(--global-tilt-y, 0));
  --shared-tilt-strength-signal: var(--shared-tilt-strength, var(--global-tilt-strength, 0));
  --shared-bend-signal: var(--shared-bend, var(--global-bend-intensity, 0));
  --shared-warp-signal: var(--shared-warp, var(--global-warp, 0));
  --shared-scroll-signal: var(--shared-scroll, var(--global-scroll-momentum, 0));
  --shared-scroll-direction-signal: var(--shared-scroll-direction, var(--global-scroll-direction, 0));
  --shared-scroll-speed-signal: var(--shared-scroll-speed, var(--global-scroll-speed, 0));
  --shared-focus-trend-signal: var(--shared-focus-trend, var(--global-focus-trend, 0));
  --shared-tilt-skew-signal: var(--shared-tilt-skew, var(--global-tilt-skew, 0));
  transition:
    box-shadow 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94),
    border-color 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94),
    filter 0.6s ease,
    opacity 0.6s ease;
  will-change: transform, box-shadow, filter;
  contain: layout paint;
  opacity: calc(0.68 + var(--card-visibility-factor) * 0.32);
}

.global-visualizer-card[data-support-role="primary"],
[data-visualizer-card][data-support-role="primary"] {
  z-index: 5;
  filter: saturate(calc(1.05 + var(--card-focus-strength) * 0.45 + var(--shared-synergy-signal) * 0.4))
    brightness(calc(1 + var(--card-focus-strength) * 0.2 + var(--shared-focus-signal) * 0.18 + var(--shared-focus-trend-signal) * 0.1));
  transform: translateZ(calc(var(--shared-focus-trend-signal) * 16px));
  box-shadow:
    0 0 calc(18px + var(--card-focus-strength) * 36px) color-mix(in srgb, var(--global-brand-accent) 60%, transparent),
    0 0 calc(32px + var(--shared-synergy-signal) * 48px) rgba(12, 20, 40, 0.32);
  border-color: color-mix(in srgb, var(--global-brand-accent) 35%, rgba(255, 255, 255, 0.25));
}

.global-visualizer-card[data-support-distance="0"],
[data-visualizer-card][data-support-distance="0"] {
  --support-distance-z: 22px;
  --support-distance-glow: 0.24;
}

.global-visualizer-card[data-support-distance="1"],
[data-visualizer-card][data-support-distance="1"] {
  --support-distance-z: 14px;
  --support-distance-glow: 0.16;
}

.global-visualizer-card[data-support-distance="2"],
[data-visualizer-card][data-support-distance="2"] {
  --support-distance-z: 8px;
  --support-distance-glow: 0.08;
}

.global-visualizer-card[data-support-distance="visible"],
[data-visualizer-card][data-support-distance="visible"] {
  --support-distance-z: 10px;
  --support-distance-glow: 0.12;
}

.global-visualizer-card[data-support-distance="far"],
[data-visualizer-card][data-support-distance="far"] {
  --support-distance-z: -8px;
  --support-distance-glow: -0.06;
}

.global-visualizer-card[data-support-role="supporting"],
[data-visualizer-card][data-support-role="supporting"] {
  opacity: calc(0.82 + var(--card-support-intensity) * 0.18 + var(--shared-synergy-signal) * 0.12);
  filter: saturate(calc(0.86 + var(--card-focus-strength) * 0.2 + var(--shared-synergy-signal) * 0.28));
  transform: perspective(1600px)
    rotateX(calc(
      (0.5 - var(--card-focus-y)) * 22deg +
      var(--card-scroll-momentum) * 4deg +
      var(--shared-tilt-y-signal) * 16deg
    ))
    rotateZ(calc(
      var(--card-twist) * 0.82 +
      var(--shared-warp-signal) * 6deg +
      var(--shared-scroll-signal) * 4deg +
      var(--shared-tilt-skew-signal) * 4deg
    ))
    translateZ(calc(
      var(--card-focus-strength) * 26px +
      var(--shared-focus-signal) * 18px +
      var(--shared-bend-signal) * 20px +
      var(--shared-focus-trend-signal) * 28px +
      var(--shared-scroll-speed-signal) * 12px
    ))
    translateY(calc(
      (var(--card-focus-y) - 0.5) * -18px +
      var(--shared-focus-trend-signal) * -16px
    ))
    scale(calc(
      1 + var(--card-focus-strength) * 0.04 +
      var(--card-support-intensity) * 0.02 +
      var(--shared-synergy-signal) * 0.04
    ));
}

.global-visualizer-card[data-support-role="ambient"],
[data-visualizer-card][data-support-role="ambient"] {
  opacity: calc(0.72 + var(--card-support-intensity) * 0.2 + var(--shared-synergy-signal) * 0.1);
  filter: saturate(calc(0.78 + var(--card-focus-strength) * 0.18 + var(--shared-synergy-signal) * 0.18));
  transform: perspective(1500px)
    rotateX(calc(
      (0.5 - var(--card-focus-y)) * 18deg +
      var(--card-scroll-momentum) * 2deg +
      var(--shared-tilt-y-signal) * 14deg
    ))
    rotateZ(calc(
      var(--card-twist) * 0.65 +
      var(--shared-warp-signal) * 5deg +
      var(--shared-scroll-signal) * 3deg
    ))
    translateZ(calc(
      var(--card-focus-strength) * 18px +
      var(--shared-bend-signal) * 16px +
      var(--shared-focus-signal) * 12px
    ))
    scale(calc(0.98 + var(--card-support-intensity) * 0.02 + var(--shared-synergy-signal) * 0.03));
}

.global-visualizer-card[data-support-role="neutral"],
[data-visualizer-card][data-support-role="neutral"] {
  opacity: calc(0.85 + var(--card-support-intensity) * 0.12 + var(--shared-synergy-signal) * 0.12);
  filter: saturate(calc(0.9 + var(--card-focus-strength) * 0.18 + var(--shared-synergy-signal) * 0.2));
  transform: perspective(1550px)
    rotateX(calc(
      (0.5 - var(--card-focus-y)) * 20deg +
      var(--card-scroll-momentum) * 3deg +
      var(--shared-tilt-y-signal) * 15deg
    ))
    rotateZ(calc(
      var(--card-twist) * 0.74 +
      var(--shared-warp-signal) * 5deg +
      var(--shared-scroll-signal) * 3.5deg
    ))
    translateZ(calc(
      var(--card-focus-strength) * 22px +
      var(--shared-bend-signal) * 18px +
      var(--shared-focus-signal) * 16px
    ))
    scale(calc(1 + var(--card-support-intensity) * 0.015 + var(--shared-synergy-signal) * 0.035));
}

.global-visualizer-card::before,
[data-visualizer-card]::before {
  content: '';
  position: absolute;
  inset: -14%;
  background: radial-gradient(
    circle at calc(var(--card-focus-x) * 100%) calc(var(--card-focus-y) * 100%),
    rgba(0, 255, 255, calc(0.18 + var(--card-focus-strength) * 0.4 + var(--card-support-intensity) * 0.2)),
    rgba(132, 56, 255, calc(0.12 + var(--card-support-intensity) * 0.25)) 45%,
    rgba(12, 12, 32, 0) 78%
  );
  opacity: calc(0.35 + var(--card-focus-strength) * 0.5 + var(--card-support-intensity) * 0.25 + var(--group-synergy, 0) * 0.3 + var(--support-distance-glow, 0) + (var(--card-visibility-factor) - 1) * 0.15);
  filter: blur(calc(22px - var(--card-focus-strength) * 8px - var(--group-synergy, 0) * 6px - var(--global-tilt-strength) * 4px + (1 - var(--card-visibility-factor)) * 6px));
  transform:
    translateZ(calc(-24px + var(--support-distance-glow, 0) * 60px - var(--global-bend-intensity) * 24px))
    rotateZ(calc(var(--global-warp) * 6deg))
    scale(calc(1.08 + var(--group-synergy, 0) * 0.06 + var(--global-tilt-strength) * 0.04));
  pointer-events: none;
  z-index: 0;
  transition: opacity 0.6s ease, filter 0.6s ease;
}

.global-visualizer-card::after,
[data-visualizer-card]::after {
  content: '';
  position: absolute;
  inset: -8%;
  border-radius: inherit;
  border: 1px solid rgba(255, 255, 255, calc(0.1 + var(--card-support-intensity) * 0.3 + var(--support-distance-glow, 0) * 0.4));
  opacity: calc(0.25 + var(--card-focus-strength) * 0.35 + var(--group-synergy, 0) * 0.2 + var(--support-distance-glow, 0) * 0.6 + (var(--card-visibility-factor) - 1) * 0.12 + var(--global-bend-intensity) * 0.15);
  filter: blur(calc(6px - var(--card-focus-strength) * 2px - var(--group-synergy, 0) * 1.2px - var(--global-tilt-strength) * 1.5px + (1 - var(--card-visibility-factor)) * 2px));
  pointer-events: none;
  z-index: 1;
  mix-blend-mode: screen;
  transition: opacity 0.6s ease, filter 0.6s ease;
}

.global-visualizer-card,
[data-visualizer-card] {
  transform:
    perspective(calc(1600px - var(--global-bend-intensity) * 320px))
    rotateX(calc(
      (0.5 - var(--card-focus-y)) * 26deg +
      var(--card-scroll-momentum) * 6deg +
      var(--global-tilt-y) * 24deg
    ))
    rotateZ(calc(var(--card-twist) + var(--global-warp) * 8deg))
    translateZ(calc(var(--card-focus-strength) * 48px + var(--support-distance-z) + var(--global-bend-intensity) * 24px))
    scale(calc(1 + var(--card-focus-strength) * 0.06 + var(--card-support-intensity) * 0.03 + var(--global-bend-intensity) * 0.02));
  box-shadow:
    0 30px 70px rgba(8, 12, 32, calc((0.25 + var(--card-focus-strength) * 0.35) * (0.5 + var(--card-visibility-factor) * 0.5))),
    0 12px 34px rgba(0, 240, 255, calc((0.12 + var(--card-support-intensity) * 0.3) * (0.5 + var(--card-visibility-factor) * 0.5))),
    inset 0 1px 0 rgba(255, 255, 255, calc((0.2 + var(--card-focus-strength) * 0.3) * (0.6 + var(--card-visibility-factor) * 0.4)));
  border: 1px solid rgba(255, 255, 255, calc(0.18 + var(--card-focus-strength) * 0.35));
  filter: saturate(calc(1 + var(--card-focus-strength) * 0.4 + var(--card-support-intensity) * 0.3))
    saturate(calc(1 + var(--global-tilt-strength) * 0.18))
    brightness(calc(1 + var(--card-support-intensity) * 0.15 + (var(--card-visibility-factor) - 1) * 0.08 + var(--global-bend-intensity) * 0.12));
}

.global-visualizer-card .global-brand-overlay,
[data-visualizer-card] .global-brand-overlay {
  position: absolute;
  inset: -22%;
  z-index: 2;
  border-radius: inherit;
  pointer-events: none;
  background-size: cover;
  background-position: center;
  opacity: calc((0.2 + var(--card-focus-strength) * 0.55 + var(--card-support-intensity) * 0.35 + var(--group-synergy, 0) * 0.18 + (var(--card-visibility-factor) - 1) * 0.25 + var(--support-distance-glow, 0) * 0.5) * var(--brand-overlay-opacity, 1));
  mix-blend-mode: var(--brand-overlay-blend, screen);
  filter:
    saturate(calc(1.2 + var(--card-focus-strength) * 1.4 + var(--group-synergy, 0) * 0.6))
    blur(calc((0.4 - var(--card-focus-strength) * 0.3 - var(--group-synergy, 0) * 0.1 - var(--global-tilt-strength) * 0.08 + (1 - var(--card-visibility-factor)) * 0.2) * 18px))
    var(--brand-overlay-filter, brightness(1));
  transform:
    translateZ(calc(18px + var(--card-focus-strength) * 36px + var(--group-synergy, 0) * 24px + var(--support-distance-z) * 0.4 + var(--brand-overlay-depth, 0px) + var(--global-bend-intensity) * 32px))
    rotateX(calc(var(--card-scroll-momentum) * -1.8deg + var(--group-synergy, 0) * -1.2deg + var(--global-tilt-y) * -18deg))
    rotateZ(calc(var(--brand-overlay-rotate, 0deg) + var(--global-warp) * 10deg));
  transition: opacity 0.5s ease, filter 0.6s ease, transform 0.6s ease;
}

.global-brand-overlay video,
.global-brand-overlay img {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  opacity: 0.9;
  filter: inherit;
  mix-blend-mode: inherit;
}

.global-brand-overlay::after {
  content: '';
  position: absolute;
  inset: -10%;
  background: radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.45), rgba(255, 255, 255, 0));
  opacity: calc(0.45 + var(--card-focus-strength) * 0.4 + (var(--card-visibility-factor) - 1) * 0.2);
  transform: translateZ(12px);
}

.global-visualizer-card canvas[data-visualizer],
.global-visualizer-card canvas[data-vib34d],
.global-visualizer-card canvas[class*="visualizer"],
.global-visualizer-card canvas[class*="hologram"],
.global-visualizer-card .holographic-canvas canvas,
[data-visualizer-card] canvas[data-visualizer],
[data-visualizer-card] canvas[data-vib34d],
[data-visualizer-card] canvas[class*="visualizer"],
[data-visualizer-card] canvas[class*="hologram"],
[data-visualizer-card] .holographic-canvas canvas {
  position: absolute;
  inset: calc(-18% - var(--global-bend-intensity) * 4%);
  width: calc(136% + var(--global-bend-intensity) * 18%);
  height: calc(136% + var(--global-bend-intensity) * 18%);
  transform:
    translateZ(calc(-36px + var(--card-focus-strength) * -18px - var(--group-synergy, 0) * 16px + var(--support-distance-z) * -0.6 + var(--card-canvas-depth, 0px) - var(--global-bend-intensity) * 28px))
    rotateX(calc((0.5 - var(--card-focus-y)) * 18deg + var(--card-scroll-momentum) * 4deg + var(--group-synergy, 0) * 2deg + var(--global-tilt-y) * 20deg))
    rotateZ(calc(var(--card-rotation-phase, 0) * 18deg + var(--global-warp) * 12deg))
    scale3d(
      calc(1 + var(--card-canvas-scale, 0) + var(--global-bend-intensity) * 0.04),
      calc(1 + var(--card-canvas-scale, 0) + var(--global-bend-intensity) * 0.04),
      1
    );
  filter: saturate(calc(1.1 + var(--card-focus-strength) * 0.4 + var(--group-synergy, 0) * 0.25 + (var(--card-visibility-factor) - 1) * 0.3 + var(--global-tilt-strength) * 0.2))
    hue-rotate(calc(var(--global-warp) * 14deg));
  pointer-events: none;
  transition: transform 0.6s ease, filter 0.6s ease;
}

body[data-global-brand-palette="meta"] .global-visualizer-card::before,
body[data-global-brand-palette="meta"] [data-visualizer-card]::before {
  background: radial-gradient(circle at 50% 20%, rgba(255, 255, 255, 0.32), rgba(30, 52, 92, 0));
}

body[data-global-brand-palette="immersive"] .global-brand-overlay::after,
body[data-global-brand-palette="immersive"] [data-visualizer-card] .global-brand-overlay::after {
  background: radial-gradient(circle at 60% 40%, rgba(72, 0, 255, 0.45), rgba(0, 0, 0, 0));
}

body[data-global-brand-palette="concept"] .global-brand-overlay::after,
body[data-global-brand-palette="concept"] [data-visualizer-card] .global-brand-overlay::after {
  background: radial-gradient(circle at 40% 60%, rgba(0, 255, 213, 0.48), rgba(0, 0, 0, 0));
}

.global-visualizer-card[data-has-focus="true"]::before,
[data-visualizer-card][data-has-focus="true"]::before {
  opacity: calc(0.5 + var(--card-focus-strength) * 0.35);
}

.global-visualizer-card[data-has-focus="true"]::after,
[data-visualizer-card][data-has-focus="true"]::after {
  opacity: calc(0.38 + var(--card-focus-strength) * 0.4);
}

.global-visualizer-card .supporting-layer,
[data-visualizer-card] .supporting-layer {
  transform: translateZ(calc(-20px + var(--card-support-intensity) * -10px));
  opacity: calc(0.6 + var(--card-support-intensity) * 0.4);
  transition: transform 0.6s ease, opacity 0.6s ease;
}

.global-visualizer-card[data-interaction-active="true"],
[data-visualizer-card][data-interaction-active="true"] {
  filter: brightness(calc(1.05 + var(--card-focus-strength) * 0.2));
}

@media (prefers-reduced-motion: reduce) {
  .global-visualizer-card,
  [data-visualizer-card] {
    transition: none;
    transform: none !important;
    box-shadow: none;
  }

  .global-visualizer-card::before,
  [data-visualizer-card]::before,
  .global-visualizer-card::after,
  [data-visualizer-card]::after,
  .global-visualizer-card .global-brand-overlay,
  [data-visualizer-card] .global-brand-overlay {
    transition: none;
  }
}
