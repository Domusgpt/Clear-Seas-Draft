:root {
  --global-focus-x: 0.5;
  --global-focus-y: 0.5;
  --global-focus-amount: 0;
  --global-scroll-momentum: 0;
  --global-scroll-tilt: 0deg;
  --global-synergy-glow: 0;
}

body {
  --global-background-shift-x: calc((var(--global-focus-x) - 0.5) * 12px + var(--global-scroll-momentum) * 18px);
  --global-background-shift-y: calc((0.5 - var(--global-focus-y)) * 10px);
  background-position: calc(50% + var(--global-background-shift-x)) calc(50% + var(--global-background-shift-y));
  transition: background-position 0.8s ease, filter 0.8s ease;
}

.global-visualizer-card,
[data-visualizer-card] {
  position: relative;
  transform-style: preserve-3d;
  --card-focus-x: 0.5;
  --card-focus-y: 0.5;
  --card-focus-strength: 0;
  --card-support-intensity: 0;
  --card-scroll-momentum: 0;
  --card-twist: 0deg;
  --card-pulse: 0;
  --card-overlay-shift: 0px;
  transition:
    box-shadow 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94),
    border-color 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94),
    filter 0.6s ease;
  will-change: transform, box-shadow, filter;
  contain: layout paint;
}

.global-visualizer-card::before,
[data-visualizer-card]::before {
  content: '';
  position: absolute;
  inset: -14%;
  background: radial-gradient(
    circle at calc(var(--card-focus-x) * 100%) calc(var(--card-focus-y) * 100%),
    rgba(0, 255, 255, calc(0.18 + var(--card-focus-strength) * 0.4 + var(--card-support-intensity) * 0.2)),
    rgba(132, 56, 255, calc(0.12 + var(--card-support-intensity) * 0.25)) 45%,
    rgba(12, 12, 32, 0) 78%
  );
  opacity: calc(0.35 + var(--card-focus-strength) * 0.5 + var(--card-support-intensity) * 0.25);
  filter: blur(calc(22px - var(--card-focus-strength) * 8px));
  transform: translateZ(-24px) scale(1.08);
  pointer-events: none;
  z-index: 0;
  transition: opacity 0.6s ease, filter 0.6s ease;
}

.global-visualizer-card::after,
[data-visualizer-card]::after {
  content: '';
  position: absolute;
  inset: -8%;
  border-radius: inherit;
  border: 1px solid rgba(255, 255, 255, calc(0.1 + var(--card-support-intensity) * 0.3));
  opacity: calc(0.25 + var(--card-focus-strength) * 0.35);
  filter: blur(calc(6px - var(--card-focus-strength) * 2px));
  pointer-events: none;
  z-index: 1;
  mix-blend-mode: screen;
  transition: opacity 0.6s ease, filter 0.6s ease;
}

.global-visualizer-card,
[data-visualizer-card] {
  transform:
    perspective(1600px)
    rotateX(calc((0.5 - var(--card-focus-y)) * 26deg + var(--card-scroll-momentum) * 6deg))
    rotateY(calc((var(--card-focus-x) - 0.5) * 28deg))
    rotateZ(calc(var(--card-twist)))
    translateZ(calc(var(--card-focus-strength) * 48px))
    scale(calc(1 + var(--card-focus-strength) * 0.06 + var(--card-support-intensity) * 0.03));
  box-shadow:
    0 30px 70px rgba(8, 12, 32, calc(0.25 + var(--card-focus-strength) * 0.35)),
    0 12px 34px rgba(0, 240, 255, calc(0.12 + var(--card-support-intensity) * 0.3)),
    inset 0 1px 0 rgba(255, 255, 255, calc(0.2 + var(--card-focus-strength) * 0.3));
  border: 1px solid rgba(255, 255, 255, calc(0.18 + var(--card-focus-strength) * 0.35));
  filter: saturate(calc(1 + var(--card-focus-strength) * 0.4 + var(--card-support-intensity) * 0.3))
    brightness(calc(1 + var(--card-support-intensity) * 0.15));
}

.global-visualizer-card .global-brand-overlay,
[data-visualizer-card] .global-brand-overlay {
  position: absolute;
  inset: -22%;
  z-index: 2;
  border-radius: inherit;
  pointer-events: none;
  background-size: cover;
  background-position: center;
  opacity: calc(0.2 + var(--card-focus-strength) * 0.55 + var(--card-support-intensity) * 0.35);
  mix-blend-mode: screen;
  filter: saturate(calc(1.2 + var(--card-focus-strength) * 1.4))
    blur(calc((0.4 - var(--card-focus-strength) * 0.3) * 18px));
  transform:
    translateZ(calc(18px + var(--card-focus-strength) * 36px))
    rotateX(calc(var(--card-scroll-momentum) * -1.8deg))
    rotateY(calc(var(--card-scroll-momentum) * 1.6deg));
  transition: opacity 0.5s ease, filter 0.6s ease, transform 0.6s ease;
}

.global-brand-overlay video,
.global-brand-overlay img {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  opacity: 0.9;
  filter: inherit;
  mix-blend-mode: inherit;
}

.global-brand-overlay::after {
  content: '';
  position: absolute;
  inset: -10%;
  background: radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.45), rgba(255, 255, 255, 0));
  opacity: calc(0.45 + var(--card-focus-strength) * 0.4);
  transform: translateZ(12px);
}

.global-visualizer-card canvas[data-visualizer],
.global-visualizer-card canvas[data-vib34d],
.global-visualizer-card canvas[class*="visualizer"],
.global-visualizer-card canvas[class*="hologram"],
.global-visualizer-card .holographic-canvas canvas,
[data-visualizer-card] canvas[data-visualizer],
[data-visualizer-card] canvas[data-vib34d],
[data-visualizer-card] canvas[class*="visualizer"],
[data-visualizer-card] canvas[class*="hologram"],
[data-visualizer-card] .holographic-canvas canvas {
  position: absolute;
  inset: -18%;
  width: 136%;
  height: 136%;
  transform:
    translateZ(calc(-36px + var(--card-focus-strength) * -18px))
    rotateX(calc((0.5 - var(--card-focus-y)) * 18deg + var(--card-scroll-momentum) * 4deg))
    rotateY(calc((var(--card-focus-x) - 0.5) * 18deg));
  filter: saturate(calc(1.1 + var(--card-focus-strength) * 0.4));
  pointer-events: none;
  transition: transform 0.6s ease, filter 0.6s ease;
}

.global-visualizer-card[data-has-focus="true"]::before,
[data-visualizer-card][data-has-focus="true"]::before {
  opacity: calc(0.5 + var(--card-focus-strength) * 0.35);
}

.global-visualizer-card[data-has-focus="true"]::after,
[data-visualizer-card][data-has-focus="true"]::after {
  opacity: calc(0.38 + var(--card-focus-strength) * 0.4);
}

.global-visualizer-card .supporting-layer,
[data-visualizer-card] .supporting-layer {
  transform: translateZ(calc(-20px + var(--card-support-intensity) * -10px));
  opacity: calc(0.6 + var(--card-support-intensity) * 0.4);
  transition: transform 0.6s ease, opacity 0.6s ease;
}

.global-visualizer-card[data-interaction-active="true"],
[data-visualizer-card][data-interaction-active="true"] {
  filter: brightness(calc(1.05 + var(--card-focus-strength) * 0.2));
}

@media (prefers-reduced-motion: reduce) {
  .global-visualizer-card,
  [data-visualizer-card] {
    transition: none;
    transform: none !important;
    box-shadow: none;
  }

  .global-visualizer-card::before,
  [data-visualizer-card]::before,
  .global-visualizer-card::after,
  [data-visualizer-card]::after,
  .global-visualizer-card .global-brand-overlay,
  [data-visualizer-card] .global-brand-overlay {
    transition: none;
  }
}
